<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sejuk Teknik AC | Solusi AC Terbaik</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <style>
      :root {
        --primary: #0066cc;
        --primary-light: #e6f2ff;
        --secondary: #ff7a00;
        --dark: #2d3748;
        --light: #f8fafc;
        --gray: #718096;
        --white: #ffffff;
        --coin: #ffd700;
      }
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: "Poppins", sans-serif;
        color: var(--dark);
        line-height: 1.6;
        background-color: var(--light);
      }
      header {
        background: linear-gradient(135deg, var(--primary), #004c99);
        color: var(--white);
        padding: 2rem 1rem;
        text-align: center;
        position: relative;
        overflow: hidden;
      }
      header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path fill="rgba(255,255,255,0.05)" d="M0,0 L100,0 L100,100 L0,100 Z"></path></svg>');
        opacity: 0.1;
      }
      header h1 {
        margin: 0;
        font-size: 2.5rem;
        font-weight: 700;
        position: relative;
        display: inline-block;
        animation: freezeEffect 6s infinite;
      }
      @keyframes freezeEffect {
        0%,
        100% {
          transform: scale(1);
          color: var(--white);
          text-shadow: none;
        }
        20% {
          transform: scale(1.05);
          color: #a0e7ff;
          text-shadow: 0 0 10px rgba(160, 231, 255, 0.7);
        }
        40% {
          transform: scale(1);
          color: #7fd8ff;
          text-shadow: 0 0 15px rgba(127, 216, 255, 0.8);
        }
        60% {
          transform: scale(0.98);
          color: #b3f0ff;
          text-shadow: 0 0 20px rgba(179, 240, 255, 0.9);
        }
        80% {
          transform: scale(1.02);
          color: #d9f7ff;
          text-shadow: 0 0 25px rgba(217, 247, 255, 1);
        }
      }
      header p {
        font-size: 1.1rem;
        margin-top: 0.5rem;
        opacity: 0.9;
        position: relative;
      }
      .rating-display {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: 1rem;
      }
      .stars {
        display: flex;
        margin-right: 10px;
      }
      .star {
        color: #ddd;
        font-size: 1.5rem;
        margin-right: 2px;
        transition: color 0.3s;
      }
      .star.filled {
        color: #ffc107;
      }
      .rating-percentage {
        font-size: 1.2rem;
        font-weight: 600;
      }
      nav {
        background-color: var(--white);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        position: sticky;
        top: 0;
        z-index: 100;
      }
      .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
      }
      .logo {
        font-weight: 700;
        color: var(--primary);
        font-size: 1.2rem;
        text-decoration: none;
      }
      .nav-links {
        display: flex;
        gap: 1.5rem;
      }
      nav a {
        color: var(--dark);
        text-decoration: none;
        font-weight: 500;
        font-size: 0.95rem;
        transition: all 0.3s ease;
        position: relative;
      }
      nav a:hover {
        color: var(--primary);
      }
      nav a::after {
        content: "";
        position: absolute;
        width: 0;
        height: 2px;
        bottom: -5px;
        left: 0;
        background-color: var(--primary);
        transition: width 0.3s ease;
      }
      nav a:hover::after {
        width: 100%;
      }
      /* === NEW STYLE: AUTH INFO & BUTTONS DI HEADER === */
      .top-header-bar {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        background-color: rgba(0, 0, 0, 0.1); /* Slightly dark background for top bar */
        padding: 5px 20px;
        display: flex;
        justify-content: flex-end;
        align-items: center;
        gap: 15px;
        z-index: 5;
      }
      .auth-buttons {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .auth-btn {
        padding: 8px 16px;
        border-radius: 50px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        white-space: nowrap; 
      }
      .login-btn, .signup-btn {
        background: var(--white);
        color: var(--primary);
        border: 1px solid var(--primary);
      }
      .login-btn:hover, .signup-btn:hover {
        background: var(--primary);
        color: var(--white);
      }
      .profile-info {
        display: flex;
        align-items: center;
        gap: 10px;
        color: var(--white); /* White text for contrast */
      }
      .user-details-link {
        color: var(--white);
        text-decoration: none;
        font-size: 0.95rem;
        display: flex;
        align-items: center;
        gap: 5px;
        cursor: pointer;
        transition: color 0.3s;
      }
      .user-details-link:hover {
        color: var(--coin);
      }
      .user-details-text {
        display: flex;
        flex-direction: column;
        line-height: 1.2;
        text-align: right;
      }
      .user-name {
        font-weight: 600;
        color: var(--white);
      }
      .user-phone {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.8);
      }
      .inbox-button {
        background: none;
        border: none;
        color: var(--white);
        font-size: 1.2rem;
        cursor: pointer;
        position: relative;
        padding: 5px;
      }
      .inbox-button:hover {
        color: var(--coin);
      }
      .admin-panel-btn {
        background-color: #f44336;
        color: white;
        padding: 5px 12px;
        border-radius: 50px;
        font-size: 0.85rem;
        font-weight: 600;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 5px;
      }
      /* === END NEW STYLE HEADER === */

      .hero {
        background: linear-gradient(145deg, var(--primary), #0088ff);
        color: var(--white);
        text-align: center;
        padding: 4rem 1rem;
        position: relative;
        overflow: hidden;
      }
      /* Ganti warna background hero */
      .hero {
        background: linear-gradient(145deg, #4286f4, #373b44);
        color: var(--white);
        text-align: center;
        padding: 4rem 1rem;
        position: relative;
        overflow: hidden;
      }
      .hero::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path fill="rgba(255,255,255,0.05)" d="M0,0 L100,0 L100,100 L0,100 Z"></path></svg>');
        opacity: 0.1;
      }
      .hero::after {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        animation: shine 3s infinite;
      }
      @keyframes shine {
        0% {
          left: -100%;
        }
        20%,
        100% {
          left: 100%;
        }
      }
      .hero-content {
        max-width: 800px;
        margin: 0 auto;
        position: relative;
        z-index: 1;
      }
      .hero h1 {
        font-size: 2.2rem;
        margin-bottom: 1rem;
        font-weight: 600;
      }
      .hero p {
        font-size: 1.1rem;
        margin-bottom: 2rem;
        opacity: 0.9;
      }
      .visi-misi {
        background-color: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(5px);
        padding: 1.5rem;
        border-radius: 12px;
        margin-top: 1.5rem;
      }
      .visi-misi p {
        font-size: 1rem;
        line-height: 1.7;
      }
      .content {
        padding: 4rem 1rem;
        max-width: 1200px;
        margin: 0 auto;
      }
      .section-title {
        text-align: center;
        margin-bottom: 3rem;
      }
      .section-title h2 {
        font-size: 2rem;
        color: var(--primary);
        margin-bottom: 1rem;
        position: relative;
        display: inline-block;
      }
      .section-title h2::after {
        content: "";
        position: absolute;
        width: 50%;
        height: 3px;
        bottom: -10px;
        left: 25%;
        background: linear-gradient(90deg, var(--primary), var(--secondary));
      }
      .section-title p {
        color: var(--gray);
        max-width: 700px;
        margin: 0 auto;
      }
      .cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
      }
      .card {
        background: var(--white);
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        opacity: 0;
        transform: translateY(30px);
        position: relative; /* Penting untuk disable overlay */
      }
      .card.visible {
        opacity: 1;
        transform: translateY(0);
      }
      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }
      /* NEW: Disable Overlay Style */
      .card.disabled {
        pointer-events: none;
        opacity: 0.6;
        filter: grayscale(100%);
      }
      .card.disabled::after {
        content: "Login untuk Memesan";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        background: rgba(255, 255, 255, 0.7);
        color: var(--primary);
        font-weight: 700;
        font-size: 1.2rem;
        z-index: 5;
        cursor: not-allowed;
      }
      .card-icon {
        background-color: var(--primary-light);
        color: var(--primary);
        font-size: 2rem;
        padding: 1.5rem;
        text-align: center;
      }
      .card-content {
        padding: 1.5rem;
      }
      .card h3 {
        margin-bottom: 1rem;
        color: var(--primary);
        font-size: 1.3rem;
      }
      .card p {
        color: var(--gray);
        font-size: 0.95rem;
      }
      .btn {
        display: inline-block;
        background-color: var(--primary);
        color: var(--white);
        padding: 0.8rem 1.8rem;
        border-radius: 50px;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 4px 10px rgba(0, 102, 204, 0.3);
        border: 2px solid var(--primary);
      }
      .btn:hover {
        background-color: transparent;
        color: var(--primary);
        box-shadow: none;
      }
      .btn-whatsapp {
        background-color: #25d366;
        border-color: #25d366;
        box-shadow: 0 4px 10px rgba(37, 211, 102, 0.3);
      }
      .btn-whatsapp:hover {
        color: #25d366;
      }
      /* Footer Styles */
      .footer {
        background-color: var(--dark);
        color: var(--white);
        padding: 3rem 0 0;
      }
      .footer-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
      }
      .footer-about {
        margin-bottom: 2rem;
      }
      .footer-logo {
        display: flex;
        align-items: center;
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 1rem;
        color: var(--white);
      }
      .footer-logo i {
        margin-right: 0.5rem;
        font-size: 1.8rem;
      }
      .footer-about p {
        opacity: 0.8;
        font-size: 0.9rem;
      }
      .footer-links h3 {
        font-size: 1.2rem;
        margin-bottom: 1.5rem;
        position: relative;
        padding-bottom: 0.5rem;
      }
      .footer-links h3::after {
        content: "";
        position: absolute;
        left: 0;
        bottom: 0;
        width: 50px;
        height: 2px;
        background: var(--primary);
      }
      .footer-links ul {
        list-style: none;
      }
      .footer-links li {
        margin-bottom: 0.8rem;
      }
      .footer-links a {
        color: var(--white);
        opacity: 0.8;
        text-decoration: none;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
      }
      .footer-links a:hover {
        opacity: 1;
        padding-left: 5px;
      }
      .footer-links a i {
        margin-right: 0.5rem;
        width: 20px;
        text-align: center;
      }
      .footer-contact p {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
        opacity: 0.8;
        font-size: 0.9rem;
      }
      .footer-contact i {
        margin-right: 0.8rem;
        width: 20px;
        text-align: center;
      }
      .footer-bottom {
        text-align: center;
        padding: 1.5rem;
        background-color: rgba(0, 0, 0, 0.2);
        margin-top: 2rem;
        font-size: 0.9rem;
        opacity: 0.8;
      }
      /* New Styles for Added Features */
      /* NEW: Promo Bar dengan Info User/Admin */
      .promo-banner {
        background: linear-gradient(90deg, #ff7a00, #ff5252);
        color: white;
        padding: 0.8rem;
        text-align: center;
        font-weight: 500;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .promo-content-marquee {
        flex-grow: 1;
        overflow: hidden;
      }
      .promo-user-admin {
        position: absolute;
        left: 20px;
        top: 50%;
        transform: translateY(-50%);
        font-weight: 600;
        white-space: nowrap;
        font-size: 0.9rem;
        display: none; /* Default hidden, shown by JS */
      }
      .promo-banner a {
        color: white;
        text-decoration: none;
        margin: 0 20px;
        transition: all 0.3s ease;
      }
      .promo-banner a:hover {
        text-shadow: 0 0 5px rgba(255, 255, 255, 0.7);
      }
      .calculator {
        background: var(--white);
        border-radius: 12px;
        padding: 2rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        margin: 2rem auto;
        max-width: 600px;
      }
      .calculator h3 {
        color: var(--primary);
        margin-bottom: 1.5rem;
        text-align: center;
      }
      .form-group {
        margin-bottom: 1.5rem;
      }
      .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
      }
      .form-group select,
      .form-group input {
        width: 100%;
        padding: 0.8rem;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-family: "Poppins", sans-serif;
      }
      .result {
        background: var(--primary-light);
        padding: 1rem;
        border-radius: 8px;
        margin-top: 1.5rem;
        text-align: center;
        font-weight: 600;
        color: var(--primary);
        display: none;
      }
      .testimonials {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin: 3rem 0;
      }
      .testimonial {
        background: var(--white);
        padding: 1.5rem;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        position: relative;
      }
      .testimonial::before {
        content: '"';
        font-size: 4rem;
        color: var(--primary-light);
        position: absolute;
        top: 0;
        left: 1rem;
        line-height: 1;
      }
      .testimonial p {
        font-style: italic;
        margin-bottom: 1rem;
        position: relative;
        z-index: 1;
      }
      .testimonial .author {
        font-weight: 600;
        color: var(--primary);
      }
      .service-highlights {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin: 3rem 0;
      }
      .service-card {
        background: var(--white);
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        text-align: center;
        transition: transform 0.3s ease;
      }
      .service-card:hover {
        transform: translateY(-10px);
      }
      .service-icon {
        background: var(--primary);
        color: white;
        font-size: 2.5rem;
        padding: 1.5rem;
      }
      .service-content {
        padding: 1.5rem;
      }
      .service-content h3 {
        color: var(--primary);
        margin-bottom: 1rem;
      }
      .service-content p {
        color: var(--gray);
        font-size: 0.95rem;
      }
      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 2rem;
        margin: 3rem 0;
      }
      .stat-item {
        text-align: center;
        padding: 1.5rem;
        background: var(--white);
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      }
      .stat-icon {
        font-size: 2.5rem;
        color: var(--primary);
        margin-bottom: 1rem;
      }
      .stat-number {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary);
        margin-bottom: 0.5rem;
      }
      .stat-label {
        color: var(--gray);
        font-size: 0.9rem;
      }
      .map-container {
        height: 300px;
        margin: 3rem 0;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }
      .blog-posts {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin: 3rem 0;
      }
      .blog-card {
        background: var(--white);
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      }
      .blog-image {
        height: 200px;
        background: var(--primary-light);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--primary);
        font-size: 3rem;
      }
      .blog-content {
        padding: 1.5rem;
      }
      .blog-content h3 {
        color: var(--primary);
        margin-bottom: 1rem;
      }
      .blog-content p {
        color: var(--gray);
        margin-bottom: 1.5rem;
        font-size: 0.9rem;
      }
      .payment-methods {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        justify-content: center;
        margin: 2rem 0;
      }
      .payment-method {
        background: var(--white);
        padding: 0.5rem 1rem;
        border-radius: 50px;
        font-weight: 500;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      }
      .certificates {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        justify-content: center;
        margin: 2rem 0;
      }
      .certificate {
        background: var(--white);
        padding: 1rem;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        width: 150px;
      }
      .certificate i {
        font-size: 2rem;
        color: var(--primary);
        margin-bottom: 0.5rem;
      }
      .diagnosis {
        background: var(--white);
        border-radius: 12px;
        padding: 2rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        margin: 2rem 0;
      }
      .diagnosis-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
      }
      .diagnosis-option {
        background: var(--primary-light);
        padding: 1rem;
        border-radius: 8px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .diagnosis-option:hover {
        background: var(--primary);
        color: white;
      }
      .diagnosis-result {
        background: var(--primary-light);
        padding: 1rem;
        border-radius: 8px;
        margin-top: 1.5rem;
        display: none;
      }
      .security-banner {
        background: var(--primary-light);
        padding: 1rem;
        border-radius: 8px;
        text-align: center;
        margin: 2rem 0;
      }
      .language-switcher {
        position: absolute;
        top: 1rem;
        right: 1rem;
      }
      .language-btn {
        background: transparent;
        border: none;
        font-size: 1.2rem;
        cursor: pointer;
        padding: 0.5rem;
      }
      /* Modal styles for blog posts */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
      }
      .modal-content {
        background-color: #fefefe;
        margin: 10% auto;
        padding: 20px;
        border-radius: 10px;
        max-width: 700px;
        width: 80%;
        position: relative;
        animation: modalSlideUp 0.4s ease-out;
      }
      @keyframes modalSlideUp {
        from {
          transform: translateY(50px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      .close-btn {
        position: absolute;
        top: 10px;
        right: 20px;
        font-size: 28px;
        font-weight: bold;
        color: #aaa;
        cursor: pointer;
      }
      .close-btn:hover {
        color: #333;
      }
      /* Auth Modal Styles */
      .auth-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
      }
      .auth-modal-content {
        background-color: #fefefe;
        margin: 5% auto;
        padding: 20px;
        border-radius: 10px;
        max-width: 500px;
        width: 90%;
        position: relative;
        animation: modalSlideUp 0.4s ease-out;
      }
      .auth-step {
        display: none;
      }
      .auth-step.active {
        display: block;
      }
      .step-indicator {
        display: flex;
        justify-content: center;
        margin-bottom: 20px;
      }
      .step {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background-color: #ddd;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 10px;
        font-weight: bold;
      }
      .step.active {
        background-color: var(--primary);
        color: white;
      }
      .step.completed {
        background-color: #4caf50;
        color: white;
      }
      .google-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        background-color: #4285f4;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: 500;
        width: 100%;
        margin-bottom: 15px;
      }
      .google-btn:hover {
        background-color: #357ae8;
      }
      .divider {
        display: flex;
        align-items: center;
        margin: 15px 0;
      }
      .divider-line {
        flex-grow: 1;
        height: 1px;
        background-color: #ddd;
      }
      .divider-text {
        padding: 0 10px;
        color: #777;
      }
      .password-container {
        position: relative;
      }
      .password-toggle {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        cursor: pointer;
        color: #777;
      }
      .file-upload {
        position: relative;
        display: inline-block;
        cursor: pointer;
        width: 100%;
      }
      .file-upload input[type="file"] {
        position: absolute;
        opacity: 0;
        width: 100%;
        height: 100%;
        cursor: pointer;
      }
      .file-upload-label {
        display: block;
        padding: 10px;
        background-color: #f1f1f1;
        border: 1px dashed #ddd;
        border-radius: 5px;
        text-align: center;
        color: #777;
      }
      .notification-btn {
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        position: relative;
      }
      .notification-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background: #ff5252;
        color: white;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
        /* Start hidden/empty */
        display: none;
      }
      /* === NEW STYLE: CONFIRMATION MODAL === */
      .confirm-account-modal {
        display: none;
        position: fixed;
        z-index: 3000; /* Lebih tinggi dari modal auth */
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.8);
        justify-content: center;
        align-items: center;
      }
      .confirm-account-content {
        background-color: #fefefe;
        padding: 30px;
        border-radius: 10px;
        max-width: 500px;
        width: 90%;
        text-align: center;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      }
      .confirm-account-content h3 {
        color: var(--primary);
        margin-bottom: 20px;
      }
      .confirm-details {
        text-align: left;
        margin-bottom: 20px;
        padding: 15px;
        background-color: var(--primary-light);
        border-radius: 8px;
        font-size: 0.95rem;
      }
      .confirm-details p {
        margin: 5px 0;
      }
      .confirm-account-buttons {
        display: flex;
        justify-content: space-around;
        gap: 15px;
      }
      .confirm-account-btn {
        padding: 10px 20px;
        border-radius: 50px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        width: 50%;
      }
      .confirm-yes-btn {
        background-color: #4caf50;
        color: white;
      }
      .confirm-no-btn {
        background-color: #f44336;
        color: white;
      }

      /* Loading Screen Styles */
      .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        color: white;
        backdrop-filter: blur(5px);
      }
      .loading-text {
        font-size: 1.8rem;
        margin-bottom: 2rem;
        text-align: center;
      }
      .loading-spinner {
        width: 60px;
        height: 60px;
        border: 6px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: var(--primary);
        animation: spin 1s ease-in-out infinite;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Success Animation Styles */
      .success-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        display: none; /* Ubah kembali ke none */
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        color: white;
        backdrop-filter: blur(5px);
      }
      .success-text {
        font-size: 2rem;
        margin-bottom: 2rem;
        text-align: center;
        animation: fadeInScale 0.8s ease-out;
      }
      .success-button {
        background-color: var(--primary);
        color: white;
        border: none;
        padding: 12px 30px;
        border-radius: 50px;
        font-size: 1.2rem;
        cursor: pointer;
        animation: fadeInScale 1s ease-out 0.5s both;
      }
      @keyframes fadeInScale {
        from {
          opacity: 0;
          transform: scale(0.8);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      /* Particle Animation */
      .particles {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        pointer-events: none;
      }
      .particle {
        position: absolute;
        background-color: var(--primary);
        border-radius: 50%;
        pointer-events: none;
        opacity: 0;
        animation: float-up 3s ease-out forwards;
      }
      @keyframes float-up {
        0% {
          opacity: 0;
          transform: translateY(0) scale(0);
        }
        20% {
          opacity: 1;
          transform: translateY(-20px) scale(1);
        }
        100% {
          opacity: 0;
          transform: translateY(-100px) scale(0.5);
        }
      }

      /* SJCoin Display */
      .sjcoin-display {
        position: absolute;
        top: 20px;
        left: 20px;
        background-color: var(--coin);
        color: var(--dark);
        padding: 8px 15px;
        border-radius: 50px;
        font-weight: 600;
        display: none;
        align-items: center;
        box-shadow: 0 4px 10px rgba(255, 215, 0, 0.3);
        z-index: 50;
      }
      .sjcoin-display i {
        margin-right: 5px;
      }

      /* Notification Page */
      .notification-page {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: var(--white);
        z-index: 2000;
        overflow-y: auto;
      }
      .notification-header-page {
        background-color: var(--primary);
        color: white;
        padding: 1rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      .notification-list {
        padding: 1rem;
      }
      .notification-item {
        background-color: var(--light);
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 1rem;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      }
      .notification-item.unread {
        border-left: 4px solid var(--primary);
      }
      .notification-item-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.5rem;
      }
      .notification-item-title {
        font-weight: 600;
        color: var(--primary);
      }
      .notification-item-time {
        font-size: 0.8rem;
        color: var(--gray);
      }
      .notification-item-content {
        color: var(--dark);
        margin-bottom: 0.5rem;
      }
      .notification-item-actions {
        display: flex;
        gap: 10px;
      }

      /* Confirmation Modal */
      .confirm-modal {
        display: none;
        position: fixed;
        z-index: 2000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
      }
      .confirm-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 20px;
        border-radius: 10px;
        max-width: 400px;
        width: 90%;
        position: relative;
        animation: modalSlideUp 0.4s ease-out;
        text-align: center;
      }
      .confirm-title {
        font-size: 1.5rem;
        margin-bottom: 1rem;
        color: var(--primary);
      }
      .confirm-message {
        margin-bottom: 1.5rem;
        color: var(--dark);
      }
      .confirm-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
      }
      .confirm-btn {
        padding: 10px 20px;
        border-radius: 50px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
      }
      .confirm-yes {
        background-color: var(--primary);
        color: white;
      }
      .confirm-no {
        background-color: transparent;
        color: var(--primary);
        border: 2px solid var(--primary);
      }

      @media (max-width: 768px) {
        .nav-container {
          flex-direction: column;
          gap: 1rem;
        }
        .nav-links {
          flex-wrap: wrap;
          justify-content: center;
        }
        .auth-buttons {
          width: 100%;
          justify-content: center;
          margin-top: 10px;
        }
        header h1 {
          font-size: 2rem;
        }
        .hero h1 {
          font-size: 1.8rem;
        }
        .cards {
          grid-template-columns: 1fr;
        }
        .language-switcher {
          position: static;
          text-align: center;
          margin-top: 1rem;
        }
        .modal-content {
          width: 95%;
          margin: 20% auto;
        }
        .auth-modal-content {
          width: 95%;
          margin: 10% auto;
        }
        .sjcoin-display {
          top: 10px;
          left: 10px;
          padding: 5px 10px;
          font-size: 0.9rem;
        }
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body>
    <!-- Generic Alert Modal (NEW) - Menggantikan semua alert() -->
    <div id="genericAlertModal" class="confirm-modal" style="z-index: 3001">
      <div class="confirm-content">
        <div class="confirm-title" id="alertTitle">👋 Hai!</div>
        <div class="confirm-message" id="alertMessage">
          Pesan tidak formal dengan emoji di sini!
        </div>
        <div class="confirm-buttons">
          <button class="confirm-btn confirm-yes" id="alertCloseBtn">
            Oke, Lanjut! 👍
          </button>
        </div>
      </div>
    </div>
    <!-- End Generic Alert Modal -->

    <!-- Loading Screen (hidden by default) -->
    <div class="loading-screen" id="loadingScreen" style="display: none">
      <div class="loading-text">Tunggu siapain akun kamu!👤</div>
      <div class="loading-spinner"></div>
    </div>

    <!-- Success Screen (hidden by default) -->
    <div class="success-container" id="successContainer" data-new-user="false">
      <div class="particles" id="particles"></div>
      <div class="success-text">Sip akun udh jadi!🙏🏻</div>
      <button class="success-button" id="successButton">Thanks!</button>
    </div>

    <!-- Konfirmasi Akun Modal (NEW) -->
    <div
      class="confirm-account-modal"
      id="confirmationModal"
      style="display: none"
    >
      <div class="confirm-account-content">
        <h3>Konfirmasi Akun Dulu Yah!</h3>
        <div class="confirm-details">
          <p>Nama Lengkap: <strong id="confirmName"></strong></p>
          <p>Email: <strong id="confirmEmail"></strong></p>
          <p>Alamat: <strong id="confirmAddress"></strong></p>
          <p>Nomor Telepon: <strong id="confirmPhone"></strong></p>
        </div>
        <div class="confirm-account-buttons">
          <button
            class="confirm-account-btn confirm-yes-btn"
            id="confirmYesAccount"
          >
            Bener Akunku!✅
          </button>
          <button
            class="confirm-account-btn confirm-no-btn"
            id="confirmNoAccount"
          >
            Bukan Akunku!❎
          </button>
        </div>
      </div>
    </div>

    <!-- SJCoin Display (hidden by default) -->
    <div class="sjcoin-display" id="sjcoinDisplay">
      <i class="fas fa-coins"></i>
      <span id="sjcoinAmount">0</span> SJCoin
    </div>

    <!-- Notification Page (ubah menjadi Inbox) -->
    <div class="notification-page" id="notificationPage">
      <div class="notification-header-page">
        <button
          id="backButton"
          style="
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
          "
        >
          <i class="fas fa-arrow-left"></i>
        </button>
        <h2>Inbox</h2>
        <div></div>
        <!-- Spacer for alignment -->
      </div>
      <div class="notification-list" id="notificationList">
        <!-- Notifications will be loaded here -->
      </div>
    </div>

    <!-- Confirmation Modal (Logout - Digunakan juga oleh generic alert) -->
    <div class="confirm-modal" id="confirmModal">
      <div class="confirm-content">
        <div class="confirm-title">Konfirmasi Logout</div>
        <div class="confirm-message">Apakah Anda yakin ingin logout?</div>
        <div class="confirm-buttons">
          <button class="confirm-btn confirm-yes" id="confirmYes">Ya</button>
          <button class="confirm-btn confirm-no" id="confirmNo">Tidak</button>
        </div>
      </div>
    </div>

    <header>
      <!-- NEW: Top Header Bar for User Info -->
      <div class="top-header-bar">
        <!-- User/Admin Info Slot -->
        <div id="userHeaderSlot" class="auth-buttons">
            <!-- Content will be generated by JS -->
        </div>
        <!-- Language Switcher -->
        <div class="language-switcher">
          <button class="language-btn">🇮🇩</button>
          <button class="language-btn">🇬🇧</button>
        </div>
      </div>
      
      <h1>Sejuk Teknik AC</h1>
      <p>Solusi AC dan Kelistrikan Profesional</p>
      <div class="rating-display">
        <div class="stars">
          <span class="star" data-rating="1">★</span>
          <span class="star" data-rating="2">★</span>
          <span class="star" data-rating="3">★</span>
          <span class="star" data-rating="4">★</span>
          <span class="star" data-rating="5">★</span>
        </div>
        <!-- Persentase diubah menjadi skor / 5.0 -->
        <div class="rating-percentage">0.0/5</div>
      </div>
    </header>
    <div class="promo-banner">
      <div id="promoUserAdminInfo" class="promo-user-admin">
          <!-- Info User/Admin dipindahkan ke sini jika user login -->
      </div>
      <div class="promo-content-marquee">
          <marquee>
            <a href="https://zelwit.github.io/Sejuk-TeknikAC/cuci-ac.html">🔥 Diskon 10% untuk Instalasi AC Baru sampai 31 Agustus! 🔥</a>
            <a href="https://zelwit.github.io/Sejuk-TeknikAC/cuci-ac.html">💧 Cuci AC Hemat - Mulai dari Rp 150.000! 💧</a>
            <a href="https://zelwit.github.io/Sejuk-TeknikAC/sewa-ac.html">❄️ Sewa AC Murah - Mulai Rp 500.000/bulan ❄️</a>
          </marquee>
      </div>
    </div>
    <nav>
      <div class="nav-container">
        <a href="index.html" class="logo">Sejuk Teknik</a>
        <div class="nav-links">
          <a href="index.html"><i class="fas fa-home"></i> Beranda</a>
          <a href="layanan.html"><i class="fas fa-tools"></i> Layanan</a>
          <a href="AC-Placement-Planner.html"
            ><i class="fas fa-tools"></i> 3D AC Placement Planner</a
          >
          <a href="tentang.html"><i class="fas fa-info-circle"></i> Tentang</a>
          <a href="https://wa.me/6285817818216"
            ><i class="fas fa-envelope"></i> Kontak</a
          >
          <a href="faq.html"><i class="fas fa-question-circle"></i> FAQ</a>
          <a href="rating-ulasan.html"
            ><i class="fas fa-star"></i> Rating & Ulasan</a
          >
          <a href="https://maps.app.goo.gl/uTFSMLiKuWcCRUMa6" target="_blank"
            ><i class="fas fa-map-marker-alt"></i> Lokasi</a
          >
        </div>
        <div class="auth-buttons" id="navAuthButtons">
          <!-- Tombol login/signup dipindahkan ke header atas, ini mungkin kosong atau untuk mobile -->
        </div>
      </div>
    </nav>
    <section class="hero">
      <div class="hero-content">
        <h1>Selamat Datang di Sejuk Teknik AC</h1>
        <p>
          Layanan terpercaya & profesional untuk rumah dan tempat usaha Anda
        </p>
        <div class="visi-misi">
          <p>
            Kami siap memberikan solusi terbaik dalam pemasangan, perawatan, dan
            service AC serta instalasi kelistrikan, didukung teknisi
            berpengalaman dan harga transparan.
          </p>
        </div>
        <!-- HILANGKAN TOMBOL WA DI SINI:
        <a
          href="https://wa.me/6285817818216"
          class="btn btn-whatsapp"
          target="_blank"
        >
          <i class="fab fa-whatsapp"></i> Hubungi Kami
        </a>
        -->
      </div>
    </section>
    <section class="content">
      <div class="service-highlights">
        <div class="service-card" data-service-type="cuci-ac">
          <div class="service-icon">
            <i class="fas fa-air-conditioner"></i>
          </div>
          <div class="service-content">
            <h3>Service AC</h3>
            <p>perbaiki AC anda dengan profesional</p>
            <a
              href="https://zelwit.github.io/Sejuk-TeknikAC/cuci-ac.html"
              class="btn"
              >Pesan Sekarang</a
            >
          </div>
        </div>
        <div class="service-card" data-service-type="cuci-ac">
          <div class="service-icon">
            <i class="fas fa-broom"></i>
          </div>
          <div class="service-content">
            <h3>Cuci AC</h3>
            <p>Perawatan rutin untuk performa AC optimal</p>
            <a
              href="https://zelwit.github.io/Sejuk-TeknikAC/cuci-ac.html"
              class="btn"
              >Pesan Sekarang</a
            >
          </div>
        </div>
        <div class="service-card" data-service-type="sewa-ac">
          <div class="service-icon">
            <i class="fas fa-snowflake"></i>
          </div>
          <div class="service-content">
            <h3>Sewa AC</h3>
            <p>Sewa AC berkualitas untuk acara Anda</p>
            <a
              href="https://zelwit.github.io/Sejuk-TeknikAC/sewa-ac.html"
              class="btn"
              >Pesan Sekarang</a
            >
          </div>
        </div>
      </div>
    </section>
    <section class="content">
      <div class="calculator">
        <h3><i class="fas fa-calculator"></i> Simulasi Harga Pemasangan AC</h3>
        <div class="form-group">
          <label for="ac-type">Jenis AC</label>
          <select id="ac-type">
            <option value="standard">Standard (1/2 PK)</option>
            <option value="medium">Medium (3/4 PK)</option>
            <option value="large">Large (1 PK)</option>
            <option value="xl">Extra Large (2 PK)</option>
          </select>
        </div>
        <div class="form-group">
          <label for="pipa">Panjang Pipa (meter)</label>
          <input type="number" id="pipa" min="1" max="20" value="5" />
        </div>
        <div class="form-group">
          <label for="ruangan">Luas Ruangan (m²)</label>
          <input type="number" id="ruangan" min="5" max="50" value="15" />
        </div>
        <button class="btn" onclick="calculatePrice()">Hitung Estimasi</button>
        <div class="result" id="result"></div>
      </div>
    </section>
    <section class="content">
      <div class="section-title">
        <h2>Testimoni Pelanggan</h2>
        <p>Apa kata mereka tentang layanan kami</p>
      </div>
      <!-- Tempat Testimoni Dinamis dari Firestore -->
      <div class="testimonials" id="dynamicTestimonials">
        <p style="text-align: center; color: var(--gray)">
          Memuat testimoni terbaru...
        </p>
      </div>
    </section>
    <section class="content">
      <div class="stats">
        <div class="stat-item">
          <div class="stat-icon">🧊</div>
          <div class="stat-number" data-count="300">0</div>
          <div class="stat-label">Unit AC Telah Dipasang</div>
        </div>
        <div class="stat-item">
          <div class="stat-icon">🛠️</div>
          <div class="stat-number" data-count="1000">0</div>
          <div class="stat-label">Pelanggan Puas</div>
        </div>
        <div class="stat-item">
          <div class="stat-icon">🔧</div>
          <div class="stat-number" data-count="5">0</div>
          <div class="stat-label">Tahun Pengalaman</div>
        </div>
      </div>
    </section>
    <section class="content">
      <div class="section-title">
        <h2>Wilayah Layanan Kami</h2>
        <p>Kami melayani berbagai area di Jabodetabek</p>
      </div>
      <div class="map-container">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3966.521260322283!2d106.8195613506864!3d-6.194741395493371!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zNsKwMTAnNDEuMSJTIDEwNsKwNDknMTAuMyJF!5e0!3m2!1sen!2sid!4v1621234567890!5m2!1sen!2sid"
          width="100%"
          height="100%"
          style="border: 0"
          allowfullscreen=""
          loading="lazy"
        ></iframe>
      </div>
    </section>
    <section class="content">
      <div class="section-title">
        <h2>Tips & Artikel</h2>
        <p>Informasi berguna seputar perawatan AC</p>
      </div>
      <div class="blog-posts">
        <div class="blog-card">
          <div class="blog-image">
            <i class="fas fa-question-circle"></i>
          </div>
          <div class="blog-content">
            <h3>5 Tanda AC Kamu Butuh Diservice</h3>
            <p>
              Ketahui tanda-tanda ketika AC Anda membutuhkan perawatan
              profesional sebelum masalah menjadi lebih serius.
            </p>
            <button class="btn read-more-btn" data-modal="modal1">
              Baca Selengkapnya
            </button>
          </div>
        </div>
        <div class="blog-card">
          <div class="blog-image">
            <i class="fas fa-gas-pump"></i>
          </div>
          <div class="blog-content">
            <h3>Perbedaan Freon R32 vs R410A</h3>
            <p>
              Memahami perbedaan antara dua jenis freon yang umum digunakan
              dalam AC modern saat ini.
            </p>
            <button class="btn read-more-btn" data-modal="modal2">
              Baca Selengkapnya
            </button>
          </div>
        </div>
        <div class="blog-card">
          <div class="blog-image">
            <i class="fas fa-tools"></i>
          </div>
          <div class="blog-content">
            <h3>Cara Merawat AC Agar Tahan Lama</h3>
            <p>
              Tips sederhana untuk merawat AC Anda agar tetap berfungsi optimal
              dengan usia pakai yang panjang.
            </p>
            <button class="btn read-more-btn" data-modal="modal3">
              Baca Selengkapnya
            </button>
          </div>
        </div>
      </div>
    </section>
    <div id="modal1" class="modal">
      <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h3>5 Tanda AC Kamu Butuh Diservice</h3>
        <p>
          AC yang berfungsi dengan baik adalah kenyamanan yang sering kita
          anggap remeh, sampai tiba-tiba berhenti bekerja. Berikut adalah 5
          tanda bahwa AC Anda membutuhkan perhatian profesional:
        </p>
        <ol>
          <li>
            <strong>Udara tidak sedingin biasanya</strong> - Jika AC Anda tidak
            lagi mendinginkan ruangan seperti dulu, mungkin ada masalah dengan
            kompresor atau level freon.
          </li>
          <li>
            <strong>Suara aneh atau berisik</strong> - Bunyi berdecit, berderak,
            atau bergetar keras bisa menandakan masalah mekanis.
          </li>
          <li>
            <strong>Bau tidak sedap</strong> - Bau apek bisa berarti ada jamur
            di saluran, sementara bau terbakar bisa menandakan masalah listrik.
          </li>
          <li>
            <strong>Kebocoran air</strong> - Air yang menetes dari unit dalam
            bisa berarti saluran pembuangan tersumbat.
          </li>
          <li>
            <strong>Tagihan listrik melonjak</strong> - AC yang bekerja terlalu
            keras akan mengonsumsi lebih banyak energi.
          </li>
        </ol>
        <p>
          Jangan tunda perbaikan AC Anda. Hubungi teknisi profesional Sejuk
          Teknik untuk diagnosis dan perbaikan yang tepat.
        </p>
      </div>
    </div>
    <div id="modal2" class="modal">
      <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h3>Perbedaan Freon R32 vs R410A</h3>
        <p>
          Freon adalah zat pendingin yang digunakan dalam sistem AC. Dua jenis
          yang umum saat ini adalah R32 dan R410A. Berikut perbedaannya:
        </p>

        <h4>Freon R410A</h4>
        <ul>
          <li>Campuran dari dua zat (R32 dan R125)</li>
          <li>Tekanan kerja lebih tinggi</li>
          <li>Potensi pemanasan global (GWP) 2088</li>
          <li>Lebih banyak digunakan di AC produksi lama</li>
        </ul>

        <h4>Freon R32</h4>
        <ul>
          <li>Zat tunggal (tidak campuran)</li>
          <li>Efisiensi energi lebih baik (sekitar 10%)</li>
          <li>GWP lebih rendah (675)</li>
          <li>Lebih ramah lingkungan</li>
          <li>Membutuhkan lebih sedikit isi (sekitar 30% lebih sedikit)</li>
        </ul>

        <p>
          Kebanyakan AC baru sekarang menggunakan R32 karena lebih efisien dan
          ramah lingkungan. Namun, pengisian harus dilakukan oleh teknisi
          bersertifikat karena sifatnya yang mudah terbakar.
        </p>
      </div>
    </div>
    <div id="modal3" class="modal">
      <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h3>Cara Merawat AC Agar Tahan Lama</h3>
        <p>
          Dengan perawatan yang tepat, AC Anda bisa bertahan hingga 10-15 tahun.
          Berikut tips merawat AC Anda:
        </p>

        <h4>Perawatan Rutin</h4>
        <ul>
          <li>
            <strong>Cuci filter</strong> setiap 1-2 bulan. Filter kotor
            mengurangi aliran udara dan membuat AC bekerja lebih keras.
          </li>
          <li>
            <strong>Bersihkan unit outdoor</strong> dari daun, debu, dan kotoran
            yang bisa menyumbat sirip pendingin.
          </li>
          <li>
            <strong>Service profesional</strong> setahun sekali untuk
            pemeriksaan menyeluruh dan pembersihan bagian dalam.
          </li>
        </ul>

        <h4>Penggunaan Bijak</h4>
        <ul>
          <li>
            Atur suhu ideal (24-26°C). Setiap 1°C lebih dingin meningkatkan
            konsumsi energi 6%.
          </li>
          <li>Gunakan timer atau fitur sleep mode di malam hari.</li>
          <li>
            Tutup pintu/jendela saat AC menyala untuk mempertahankan suhu.
          </li>
        </ul>

        <h4>Ketika Musim Hujan</h4>
        <ul>
          <li>
            Nyalakan AC setidaknya 15 menit seminggu sekali untuk mencegah
            kompresor macet.
          </li>
          <li>
            Jika tidak digunakan dalam waktu lama, tutup unit outdoor untuk
            melindungi dari hujan dan debu.
          </li>
        </ul>

        <p>
          Dengan perawatan rutin, AC Anda akan bekerja lebih efisien, lebih
          tahan lama, dan menghemat biaya listrik bulanan.
        </p>
      </div>
    </div>
    <section class="content">
      <div class="payment-methods">
        <div class="payment-method">✅ DANA</div>
        <div class="payment-method">✅ BCA</div>
        <div class="payment-method">✅ BRI</div>
        <div class="payment-method">✅ Mandiri</div>
        <div class="payment-method">✅ Tunai</div>
      </div>
    </section>
    <section class="content">
      <div class="section-title">
        <h2>Sertifikat & Legalitas</h2>
        <p>Bukti profesionalisme dan keahlian kami</p>
      </div>
      <div class="certificates">
        <div class="certificate">
          <i class="fas fa-certificate"></i>
          <div>Sertifikat Teknisi AC</div>
        </div>
        <div class="certificate">
          <i class="fas fa-id-card"></i>
          <div>Lisensi Resmi</div>
        </div>
        <div class="certificate">
          <i class="fas fa-shield-alt"></i>
          <div>Asuransi Kerja</div>
        </div>
      </div>
    </section>
    <section class="content">
      <div class="diagnosis">
        <h3><i class="fas fa-stethoscope"></i> Diagnosa Masalah AC</h3>
        <p>Pilih gejala yang Anda alami:</p>
        <div class="diagnosis-options">
          <div class="diagnosis-option" onclick="showDiagnosis('tidak-dingin')">
            AC tidak dingin
          </div>
          <div class="diagnosis-option" onclick="showDiagnosis('keluar-air')">
            Keluar air
          </div>
          <div class="diagnosis-option" onclick="showDiagnosis('berisik')">
            Berisik
          </div>
          <div class="diagnosis-option" onclick="showDiagnosis('mati-total')">
            Mati total
          </div>
        </div>
        <div class="diagnosis-result" id="diagnosis-result"></div>
      </div>
    </section>
    <section class="content">
      <div class="security-banner">
        <i class="fas fa-lock"></i> Data Anda Aman – Kami tidak menyebarkan
        nomor HP atau foto properti Anda
      </div>
    </section>
    <footer class="footer">
      <div class="footer-container">
        <div class="footer-about">
          <div class="footer-logo">
            <i class="fas fa-snowflake"></i>
            Sejuk Teknik AC
          </div>
          <p>
            Solusi AC dan kelistrikan profesional sejak 2020. Memberikan
            pelayanan terbaik dengan teknisi berpengalaman dan harga terjangkau.
          </p>
        </div>
        <div class="footer-links">
          <h3>Menu</h3>
          <ul>
            <li>
              <a href="index.html"><i class="fas fa-home"></i> Beranda</a>
            </li>
            <li>
              <a href="layanan.html"><i class="fas fa-tools"></i> Layanan</a>
            </li>
            <li>
              <a href="AC-Placement-Planner.html"
                ><i class="fas fa-cube"></i> 3D AC Planner</a
              >
            </li>
            <li>
              <a href="tentang.html"
                ><i class="fas fa-info-circle"></i> Tentang</a
              >
            </li>
            <li>
              <a href="https://wa.me/6285817818216"
                ><i class="fas fa-phone-alt"></i> Kontak</a
              >
            </li>
          </ul>
        </div>
        <div class="footer-links">
          <h3>Layanan</h3>
          <ul>
            <li>
              <a href="#"
                ><i class="fas fa-air-conditioner"></i> Instalasi AC</a
              >
            </li>
            <li>
              <a href="cuci-ac.html"><i class="fas fa-broom"></i> Cuci AC</a>
            </li>
            <li>
              <a href="cuci-ac.html"><i class="fas fa-tools"></i> Service AC</a>
            </li>
            <li>
              <a href="panel-distribusi.html"
                ><i class="fas fa-bolt"></i> Instalasi Listrik</a
              >
            </li>
            <li>
              <a href="sewa-ac.html"
                ><i class="fas fa-snowflake"></i> Sewa AC</a
              >
            </li>
          </ul>
        </div>
        <div class="footer-contact">
          <h3>Kontak Kami</h3>
          <p><i class="fab fa-whatsapp"></i> WhatsApp: 85817818216</p>
          <p>
            <i class="fas fa-envelope"></i> Email:
            jayatehnikmandiri234@gmail.com
          </p>
          <p><i class="fas fa-clock"></i> Buka: 09:00 - 07:00 WIB</p>
          <p>
            <i class="fas fa-map-marker-alt"></i> Jl. Raya Perjuangan No.25
            RT.16 RW.07, Tugu Selatan Koja
          </p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>© 2025 Sejuk Teknik AC. All Rights Reserved.</p>
      </div>
    </footer>

    <div id="loginModal" class="auth-modal">
      <div class="auth-modal-content">
        <span class="close-btn">&times;</span>
        <h2>Login ke Akun Anda</h2>
        <button class="google-btn" id="googleLoginBtn">
          <i class="fab fa-google"></i> Masuk dengan Google
        </button>
        <div class="divider">
          <div class="divider-line"></div>
          <div class="divider-text">atau</div>
          <div class="divider-line"></div>
        </div>
        <div class="form-group">
          <label for="loginEmail">Email</label>
          <input type="email" id="loginEmail" placeholder="Email Anda" />
        </div>
        <div class="form-group">
          <label for="loginPassword">Kata Sandi</label>
          <div class="password-container">
            <input
              type="password"
              id="loginPassword"
              placeholder="Kata sandi"
            />
            <button class="password-toggle" id="toggleLoginPassword">
              <i class="fas fa-eye"></i>
            </button>
          </div>
        </div>
        <button class="btn" id="loginSubmitBtn">Login</button>
        <p style="text-align: center; margin-top: 15px">
          Belum punya akun? <a href="#" id="switchToSignup">Daftar sekarang</a>
        </p>
      </div>
    </div>

    <div id="signupModal" class="auth-modal">
      <div class="auth-modal-content">
        <span class="close-btn">&times;</span>
        <div class="step-indicator">
          <div class="step active" data-step="1">1</div>
          <div class="step" data-step="2">2</div>
          <div class="step" data-step="3">3</div>
        </div>

        <div class="auth-step active" id="signupStep1">
          <h2>Daftar Akun Baru</h2>
          <button class="google-btn" id="googleSignupBtn">
            <i class="fab fa-google"></i> Daftar dengan Google
          </button>
          <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-text">atau</div>
            <div class="divider-line"></div>
          </div>
          <div class="form-group">
            <label for="signupName">Nama Lengkap</label>
            <input
              type="text"
              id="signupName"
              placeholder="Nama lengkap Anda"
            />
          </div>
          <button class="btn" id="signupStep1Btn">Lanjut</button>
          <p style="text-align: center; margin-top: 15px">
            Sudah punya akun? <a href="#" id="switchToLogin">Masuk sekarang</a>
          </p>
        </div>

        <div class="auth-step" id="signupStep2">
          <h2>Informasi Tambahan</h2>
          <div class="form-group">
            <label for="signupAddress">Alamat</label>
            <input
              type="text"
              id="signupAddress"
              placeholder="Alamat lengkap Anda"
            />
          </div>
          <div class="form-group">
            <label for="signupPhone">Nomor Telepon</label>
            <input
              type="tel"
              id="signupPhone"
              placeholder="Nomor telepon aktif"
            />
          </div>
          <div class="form-group">
            <label>Unggah Foto (Opsional)</label>
            <div class="file-upload">
              <input type="file" id="signupFile" accept="image/*" />
              <label for="signupFile" class="file-upload-label">
                <i class="fas fa-cloud-upload-alt"></i> Klik untuk unggah foto
              </label>
            </div>
          </div>
          <div style="display: flex; justify-content: space-between">
            <button
              class="btn"
              style="background-color: #ccc; color: #333"
              id="signupBackBtn"
            >
              Kembali
            </button>
            <button class="btn" id="signupStep2Btn">Lanjut</button>
          </div>
        </div>

        <div class="auth-step" id="signupStep3">
          <h2>Buat Akun Anda</h2>
          <div class="form-group">
            <label for="signupEmail">Email</label>
            <input
              type="email"
              id="signupEmail"
              placeholder="Masukkan email Anda"
            />
          </div>
          <div class="form-group">
            <label for="signupPassword">Kata Sandi</label>
            <div class="password-container">
              <input
                type="password"
                id="signupPassword"
                placeholder="Buat kata sandi kuat"
              />
              <button class="password-toggle" id="toggleSignupPassword">
                <i class="fas fa-eye"></i>
              </button>
            </div>
            <small style="color: #666"
              >Gunakan minimal 8 karakter dengan kombinasi huruf, angka, dan
              simbol</small
            >
          </div>
          <div class="form-group">
            <label for="signupConfirmPassword">Konfirmasi Kata Sandi</label>
            <div class="password-container">
              <input
                type="password"
                id="signupConfirmPassword"
                placeholder="Konfirmasi kata sandi"
              />
              <button class="password-toggle" id="toggleSignupConfirmPassword">
                <i class="fas fa-eye"></i>
              </button>
            </div>
          </div>
          <div style="display: flex; justify-content: space-between">
            <button
              class="btn"
              style="background-color: #ccc; color: #333"
              id="signupBackBtn2"
            >
              Kembali
            </button>
            <button class="btn" id="signupSubmitBtn">Daftar Sekarang</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Initialize Firebase
      // Ganti dengan konfigurasi Firebase Anda
      const firebaseConfig = {
        apiKey: "AIzaSyDtLHSz7-KU97ALJTQvLRQTG5yj7brcsvc", // Tetap rahasiakan API Key Anda
        authDomain: "sejuk-teknik.firebaseapp.com",
        projectId: "sejuk-teknik",
        storageBucket: "sejuk-teknik.appspot.com", // pastikan ini benar
        messagingSenderId: "733860478343",
        appId: "1:733860478343:web:172838a08e702d129ae722",
        measurementId: "G-EDJ6Y6J7GC",
      };

      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();

      // Cooldown variables
      let lastLoginTime = 0;
      let lastLogoutTime = 0;
      const COOLDOWN_TIME = 5000; // 5 seconds

      // Variable Global untuk melacak apakah ini adalah pendaftaran pertama user
      let isFirstSignup = false;
      // Variable Global untuk menyimpan data user yang sedang diproses untuk konfirmasi
      let pendingUserData = null;
      
      // ADMIN UIDS (DIPERBAIKI)
      const ADMIN_UIDS = [
          '7aIizseExGVPkqNJouqt3nMdWtE3', 
          'f3M49osGvtcGbEWf9UTdJe1AG013', 
      ];

      // ===============================================
      // FUNGSI BARU: GENERIC ALERT MODAL (Menggantikan alert())
      // ===============================================
      function showCustomAlert(title, message, isError = false) {
        const modal = document.getElementById("genericAlertModal");
        const modalTitle = document.getElementById("alertTitle");
        const modalMessage = document.getElementById("alertMessage");
        const closeBtn = document.getElementById("alertCloseBtn");

        modalTitle.textContent = title;
        modalMessage.innerHTML = message; // Use innerHTML for emojis/formatting

        if (isError) {
          modalTitle.style.color = "#f44336"; // Merah untuk error
          closeBtn.textContent = "Baiklah 😥";
          closeBtn.style.backgroundColor = "#f44336";
        } else {
          modalTitle.style.color = "var(--primary)"; // Biru untuk info
          closeBtn.textContent = "Oke, Lanjut! 👍";
          closeBtn.style.backgroundColor = "var(--primary)";
        }

        modal.style.display = "flex";
        document.body.style.overflow = "hidden";

        closeBtn.onclick = () => {
          modal.style.display = "none";
          document.body.style.overflow = "auto";
        };
      }

      // FUNGSI: Map pesan formal menjadi informal + emoji
      function mapGenericAlert(formalMessage) {
        let title = "Info Dulu Ya! 📣";
        let message = formalMessage;

        if (formalMessage.includes("Fitur ganti bahasa")) {
          message =
            "Ganti bahasanya lagi disiapin ya! Tunggu sebentar lagi, pasti seru! 🥳";
        } else if (formalMessage.includes("Tunggu beberapa saat")) {
          message = "Sabar, jangan buru-buru! Coba lagi 5 detik dari sekarang ya. 😉";
        } else if (formalMessage.includes("minimal 8 karakter")) {
          title = "Password Kurang Kuat! 🛡️";
          message =
            "Password-nya minimal harus 8 karakter ya. Campur huruf, angka, dan simbol biar aman!";
        } else if (formalMessage.includes("tidak cocok")) {
          title = "Password Gak Sama! 🙅‍♂️";
          message =
            "Password dan Konfirmasi Password-nya harus sama persis ya. Cek lagi ketikannya!";
        } else if (formalMessage.includes("harus diisi")) {
          title = "Lengkapi Dulu Yuk! 📝";
          message =
            "Semua kolom yang wajib diisi belum terisi nih. Jangan sampai ada yang kelewat ya!";
        } else if (formalMessage.includes("berhasil logout")) {
          title = "Sampai Jumpa Lagi! 👋";
          message =
            "Kamu sudah berhasil *logout*. Senang melihatmu! Kapan-kapan mampir lagi ya!";
        } else if (formalMessage.includes("Gagal untuk logout")) {
          title = "Gagal Logout! 😟";
          message = "Ada masalah saat mencoba *logout*. Coba *refresh* halaman dan ulangi.";
        } else if (formalMessage.includes("Akun dibatalkan")) {
          title = "Akun Dibatalkan! 💔";
          message = "Baiklah, pendaftaran akun ini dibatalkan. Silakan daftar ulang kalau mau ya.";
        } else if (formalMessage.includes("hadiah user baru")) {
          title = "Hadiah Siap! 🎁";
          message = "Hadiah *user* baru udh dikirim di **Inbox** kamu yah! Cek gih! 🎉";
        } else if (formalMessage.includes("Anda mendapatkan")) {
          title = "SJCoin Masuk! 💰";
          message = formalMessage;
        }
        // Tambahkan logika lain sesuai kebutuhan

        return { title, message };
      }

      // OVERRIDE: Ganti semua alert() bawaan JavaScript
      window.alert = function (message) {
        const { title, message: informalMessage } = mapGenericAlert(message);
        showCustomAlert(title, informalMessage);
      };

      // FUNGSI-FUNGSI LAINNYA DI SINI
      
      // Animate stats counters
      function animateCounters() {
        const counters = document.querySelectorAll(".stat-number");
        const speed = 200;

        counters.forEach((counter) => {
          const updateCount = () => {
            const target = +counter.getAttribute("data-count");
            const count = +counter.innerText.replace("+", ""); // Hapus '+'
            const increment = target / speed;

            if (count < target) {
              counter.innerText = Math.ceil(count + increment);
              setTimeout(updateCount, 1);
            } else {
              counter.innerText = target + "+";
            }
          };
          updateCount();
        });
      }
      
      // Price calculator
      function calculatePrice() {
        const acType = document.getElementById("ac-type").value;
        const pipa = parseInt(document.getElementById("pipa").value);
        const ruangan = parseInt(document.getElementById("ruangan").value);

        let basePrice;
        switch (acType) {
          case "standard":
            basePrice = 500000;
            break;
          case "medium":
            basePrice = 650000;
            break;
          case "large":
            basePrice = 800000;
            break;
          case "xl":
            basePrice = 1200000;
            break;
          default:
            basePrice = 500000;
        }

        const pipaCost = Math.max(0, pipa - 5) * 30000;
        const ruanganAdjustment = ruangan > 20 ? 100000 : 0;

        const total = basePrice + pipaCost + ruanganAdjustment;
        document.getElementById("result").innerHTML = `
          <p>Estimasi Biaya Pemasangan: <strong>Rp ${total.toLocaleString(
            "id-ID"
          )}</strong></p>
          <small>* Harga dapat berubah setelah survey lokasi</small>
        `;
        document.getElementById("result").style.display = "block";
      }

      // AC Diagnosis
      function showDiagnosis(problem) {
        const resultDiv = document.getElementById("diagnosis-result");
        let solution = "";

        switch (problem) {
          case "tidak-dingin":
            solution =
              "Kemungkinan: Freon habis atau kompresor bermasalah. Silakan cek layanan isi freon atau perbaikan kompresor.";
            break;
          case "keluar-air":
            solution =
              "Kemungkinan: Saluran pembuangan tersumbat atau instalasi tidak level. Kami menyediakan jasa pembersihan saluran dan perbaikan instalasi.";
            break;
          case "berisik":
            solution =
              "Kemungkinan: Kipas atau kompresor bermasalah, atau ada bagian yang longgar. Perlu pemeriksaan lebih lanjut oleh teknisi kami.";
            break;
          case "mati-total":
            solution =
              "Kemungkinan: Masalah kelistrikan atau PCB rusak. Segera hubungi teknisi kami untuk diagnosis lebih akurat.";
            break;
          default:
            solution =
              "Silakan pilih gejala yang dialami untuk diagnosa lebih lanjut.";
        }

        resultDiv.innerHTML = solution;
        resultDiv.style.display = "block";
      }

      // Card animation on scroll
      const cards = document.querySelectorAll(".card");
      const cardObserver = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add("visible");
            }
          });
        },
        { threshold: 0.1 }
      );

      cards.forEach((card) => cardObserver.observe(card));

      // Show loading screen
      function showLoadingScreen() {
        document.getElementById("loadingScreen").style.display = "flex";
      }

      // Hide loading screen
      function hideLoadingScreen() {
        document.getElementById("loadingScreen").style.display = "none";
      }

      // Show success screen (dengan flag untuk new user)
      function showSuccessScreen(isNewUser = false) {
        document.getElementById("successContainer").style.display = "flex";
        document
          .getElementById("successContainer")
          .setAttribute("data-new-user", isNewUser); // Store the flag
        createParticles();
      }

      // Hide success screen
      function hideSuccessScreen() {
        document.getElementById("successContainer").style.display = "none";
      }

      // Logic setelah klik 'Thanks!'
      function handleSuccessAction() {
        const container = document.getElementById("successContainer");
        const isNewUser = container.getAttribute("data-new-user") === "true";
        hideSuccessScreen();

        if (isNewUser) {
            window.alert('hadiah user baru udh di kirim di notif kamu yah cek gih!');
            container.setAttribute("data-new-user", "false"); // Reset flag
        }

        updateNotificationBadge();
      }

      // Fungsi untuk mengupdate badge notifikasi
      const notificationBadge = document.getElementById("notificationBadge");

      function updateNotificationBadge() {
        const user = auth.currentUser;
        if (!user) {
          return;
        }

        db.collection("notifications")
          .where("userId", "==", user.uid)
          .where("read", "==", false)
          .get()
          .then((snapshot) => {
            const count = snapshot.size;
            const inboxBtn = document.getElementById("inboxButton");

            if (inboxBtn) {
              const badge = inboxBtn.querySelector(".notification-badge");
              badge.textContent = count > 0 ? count : "";
              badge.style.display = count > 0 ? "flex" : "none";
            }
          })
          .catch((error) => {
            console.error("Error updating badge:", error);
          });
      }

      // Show notification page
      function showNotificationPage() {
        document.getElementById("notificationPage").style.display = "block";
        loadNotifications();
      }

      // Hide notification page
      function hideNotificationPage() {
        document.getElementById("notificationPage").style.display = "none";
      }

      // Load notifications from Firestore
      function loadNotifications() { 
        const notificationList = document.getElementById("notificationList");
        notificationList.innerHTML =
          '<p style="text-align: center; color: #666;">Memuat notifikasi...</p>';

        const user = auth.currentUser;
        if (!user) {
          notificationList.innerHTML =
            '<p style="text-align: center; color: #666;">Silakan login untuk melihat notifikasi</p>';
          return;
        }

        db.collection("notifications")
          .where("userId", "==", user.uid)
          .where("read", "==", false)
          .get()
          .then((snapshot) => {
            const batch = db.batch();
            snapshot.docs.forEach((doc) => {
              batch.update(doc.ref, { read: true });
            });
            return batch.commit();
          })
          .then(() => {
            db.collection("notifications")
              .where("userId", "==", user.uid)
              .orderBy("timestamp", "desc")
              .get()
              .then((querySnapshot) => {
                notificationList.innerHTML = "";

                if (querySnapshot.empty) {
                  notificationList.innerHTML =
                    '<p style="text-align: center; color: #666;">Tidak ada notifikasi</p>';
                  updateNotificationBadge(); 
                  return;
                }

                querySnapshot.forEach((doc) => {
                  const notification = doc.data();
                  const notificationItem = document.createElement("div");
                  notificationItem.classList.add("notification-item");

                  const date = notification.timestamp
                    ? new Date(notification.timestamp.toDate())
                    : new Date();
                  const formattedDate = `${date.getDate()}/${
                    date.getMonth() + 1
                  }/${date.getFullYear()} ${date.getHours()}:${date
                    .getMinutes()
                    .toString()
                    .padStart(2, "0")}`;

                  let actionButtons = "";
                  if (notification.claimed) {
                    actionButtons =
                      '<button class="notification-btn" disabled style="background-color: #ddd; color: #777; padding: 5px 15px; border-radius: 50px; font-size: 0.9rem;">Sudah Diklaim</button>';
                  } else if (notification.coinReward) {
                    actionButtons = `
                          <button class="notification-btn notification-claim" onclick="claimNotification('${doc.id}', ${notification.coinReward})">Klaim</button>
                          <button class="notification-btn notification-dismiss" onclick="dismissNotification('${doc.id}')">Hapus</button>
                      `;
                  } else {
                    actionButtons = `<button class="notification-btn notification-dismiss" onclick="dismissNotification('${doc.id}')">Hapus</button>`;
                  }

                  notificationItem.innerHTML = `
                    <div class="notification-item-header">
                      <div class="notification-item-title">${notification.title}</div>
                      <div class="notification-item-time">${formattedDate}</div>
                    </div>
                    <div class="notification-item-content">${notification.content}</div>
                    <div class="notification-item-actions">
                      ${actionButtons}
                    </div>
                  `;

                  notificationList.appendChild(notificationItem);
                });
                updateNotificationBadge(); 
              })
              .catch((error) => {
                console.error("Error loading notifications:", error);
                notificationList.innerHTML =
                  '<p style="text-align: center; color: #666;">Gagal memuat notifikasi</p>';
              });
          })
          .catch((error) => {
            console.error("Error batch updating notifications:", error);
          });
      }
      
      // Claim notification
      function claimNotification(notificationId, coinReward) {
        const user = auth.currentUser;
        if (!user || !coinReward) return;

        // Ambil elemen tombol untuk menghindari double click
        const claimBtn = document.querySelector(
          `.notification-claim[onclick*="${notificationId}"]`
        );
        if (claimBtn) claimBtn.disabled = true;

        // 1. Update notifikasi: tandai sudah diklaim
        db.collection("notifications")
          .doc(notificationId)
          .update({
            claimed: true,
          })
          .then(() => {
            // 2. Tambahkan koin ke user
            return db
              .collection("users")
              .doc(user.uid)
              .get()
              .then((userDoc) => {
                const currentCoins = userDoc.data().sjcoin || 0;
                return db
                  .collection("users")
                  .doc(user.uid)
                  .update({
                    sjcoin: currentCoins + coinReward,
                  })
                  .then(() => currentCoins + coinReward);
              });
          })
          .then((newCoins) => {
            // 3. Update UI
            document.getElementById("sjcoinAmount").textContent = newCoins;
            window.alert(
              `Anda mendapatkan ${coinReward} SJCoin! Total SJCoin Anda: ${newCoins}`
            ); 

            // Muat ulang notifikasi untuk menampilkan tombol 'Sudah Diklaim'
            loadNotifications();
          })
          .catch((error) => {
            if (claimBtn) claimBtn.disabled = false;
            console.error("Error claiming notification:", error);
            window.alert("Gagal mengklaim hadiah. Silakan coba lagi."); 
          });
      }
      
      // Dismiss notification
      function dismissNotification(notificationId) {
        db.collection("notifications")
          .doc(notificationId)
          .delete()
          .then(() => {
            // Reload notifications
            loadNotifications();
          })
          .catch((error) => {
            console.error("Error dismissing notification:", error);
          });
      }
      
      // Show confirmation modal
      function showConfirmModal() {
        document.getElementById('confirmModal').style.display = 'block';
      }
      
      // Hide confirmation modal
      function hideConfirmModal() {
        document.getElementById('confirmModal').style.display = 'none';
      }
      
      // Load Testimoni Positif ke Section
      function loadTestimonials() {
        const container = document.getElementById("dynamicTestimonials");
        container.innerHTML =
          '<p style="text-align: center; color: var(--gray);">Memuat testimoni terbaru...</p>';

        db.collection("reviews")
          .orderBy("timestamp", "desc")
          .limit(50)
          .get()
          .then((snapshot) => {
            container.innerHTML = "";
            let count = 0;
            const maxTestimonials = 6; 

            snapshot.forEach((doc) => {
              const review = doc.data();
              const rating = review.rating || 0;

              if (rating >= 4 && count < maxTestimonials) {
                const testimonial = document.createElement("div");
                testimonial.classList.add("testimonial");

                testimonial.innerHTML = `
                              <p>${review.reviewText}</p>
                              <div class="author">— ${
                                review.reviewerName || "Anonim"
                              }, ${rating} Bintang</div>
                          `;
                container.appendChild(testimonial);
                count++;
              }
            });

            if (count === 0) {
              container.innerHTML =
                '<p style="text-align: center; color: var(--gray);">Belum ada testimoni positif (Rating 4 atau 5) yang tersedia.</p>';
            }
          })
          .catch((error) => {
            console.error("Error loading testimonials:", error);
            container.innerHTML =
              '<p style="text-align: center; color: red;">Gagal memuat testimoni.</p>';
          });
      }

      // Update Rating Header (Menggunakan 'reviews')
      function updateRatingDisplay() { 
        db.collection("reviews")
          .get()
          .then((snapshot) => {
            if (snapshot.empty) {
              document.querySelector(".rating-percentage").textContent =
                "0.0/5";
              return;
            }

            let totalRating = 0;
            let ratingCount = 0;

            snapshot.forEach((doc) => {
              totalRating += doc.data().rating || 0;
              ratingCount++;
            });

            const averageRating = totalRating / ratingCount;
            const formattedScore = averageRating.toFixed(1).replace(".", ",");

            document.querySelector(".rating-percentage").textContent =
              formattedScore + "/5";

            const stars = document.querySelectorAll(".star");
            const roundedRating = Math.round(averageRating);

            stars.forEach((star, index) => {
              star.classList.remove("filled");
              if (index < roundedRating) {
                star.classList.add("filled");
              }
            });
          })
          .catch((error) => {
            console.error("Error getting ratings:", error);
          });
      }
      
      // Konfirmasi Akun (Pasca Login/Sign Up)
      function showConfirmationModal(userData, isNewUser) {
        pendingUserData = userData; // Simpan data sementara

        document.getElementById("confirmName").textContent =
          userData.name || "N/A";
        document.getElementById("confirmEmail").textContent =
          userData.email || "N/A";
        document.getElementById("confirmAddress").textContent =
          userData.address || "N/A";
        document.getElementById("confirmPhone").textContent =
          userData.phone || "N/A";

        document.getElementById("confirmationModal").style.display = "flex";
        document.body.style.overflow = "hidden";

        // Event listener untuk tombol Ya
        document.getElementById("confirmYesAccount").onclick = () => {
          document.getElementById("confirmationModal").style.display = "none";
          document.body.style.overflow = "auto";

          // Lanjut ke Success Screen
          showSuccessScreen(isNewUser);
        };

        // Event listener untuk tombol Tidak (Logout)
        document.getElementById("confirmNoAccount").onclick = () => {
          auth.signOut();
          document.getElementById("confirmationModal").style.display = "none";
          document.body.style.overflow = "auto";
          window.alert("Akun dibatalkan. Silakan login atau daftar ulang."); 
        };
      }

      // Disable/Enable Service Cards
      function toggleServiceCards(enable) {
        const serviceCards = document.querySelectorAll(".service-card");
        const sensitiveServices = ["cuci-ac", "sewa-ac"]; // Service yang di-disable jika belum login
        
        serviceCards.forEach((card) => {
          const serviceType = card.getAttribute("data-service-type");
          if (sensitiveServices.includes(serviceType)) {
            if (enable) {
              card.classList.remove("disabled");
              // Hapus event listener pencegah (biarkan tombol berjalan normal)
              card.querySelectorAll(".btn").forEach((btn) => {
                  btn.onclick = null;
              });
            } else {
              card.classList.add("disabled");
              // Tambahkan event listener untuk mencegah navigasi langsung dari button di dalam card
              card.querySelectorAll(".btn").forEach((btn) => {
                btn.onclick = (e) => {
                  e.preventDefault();
                  showCustomAlert(
                    "Eh, Belum Login! 😅", 
                    "Kamu harus *Login* dulu nih kalau mau pesan layanan *Service/Sewa AC*. Yuk, *Sign Up* dulu!",
                    true
                  );
                };
              });
            }
          }
        });
      }
      
      // Main script on DOMContentLoaded
      document.addEventListener("DOMContentLoaded", function () {
        const userHeaderSlot = document.getElementById("userHeaderSlot");
        const loginModal = document.getElementById("loginModal");
        const signupModal = document.getElementById("signupModal");
        const promoUserAdminInfo = document.getElementById("promoUserAdminInfo");

        // Panggil fungsi testimoni
        loadTestimonials();

        // Panggil fungsi update rating
        updateRatingDisplay();

        // Function to update UI based on auth state
        const updateAuthUI = (user) => {
          // Clear existing buttons
          userHeaderSlot.innerHTML = "";
          promoUserAdminInfo.style.display = 'none'; // Sembunyikan default

          if (user) {
            // User is signed in
            toggleServiceCards(true); // Enable Cards

            // Get user data including SJCoin and details
            db.collection("users")
              .doc(user.uid)
              .get()
              .then((doc) => {
                const userData = doc.data() || {};
                const userName =
                  userData.name || user.displayName || user.email.split("@")[0];
                const userPhone = userData.phone || "N/A";
                const isAdmin = ADMIN_UIDS.includes(user.uid);
                
                // --- KONTEN PROFIL & INBOX ---
                userHeaderSlot.innerHTML = `
                    <button class="inbox-button" id="inboxButton">
                        <i class="fas fa-inbox"></i>
                        <span class="notification-badge" id="notificationBadge"></span>
                    </button>
                `;
                
                // Tambahkan tombol Admin Panel jika Admin
                if (isAdmin) {
                    userHeaderSlot.innerHTML += `<a href="admin-panel.html" class="admin-panel-btn"><i class="fas fa-user-shield"></i> ADMIN</a>`;
                }

                // --- KONTEN PROMO BAR (Info Detail User) ---
                promoUserAdminInfo.innerHTML = `
                    <i class="fas fa-user-circle"></i>
                    ${isAdmin ? '<span style="color:#ffd700; font-weight:700;">ADMIN:</span> ' : ''}
                    <a href="profile.html?uid=${user.uid}" style="color:inherit; text-decoration:none;">
                        ${userName} | ${userPhone} | UID: ${user.uid.substring(0, 4)}...
                    </a>
                `;
                promoUserAdminInfo.style.display = 'block';
                
                // Atur posisi agar tidak mengganggu marquee (jika diperlukan)
                document.querySelector('.promo-content-marquee').style.marginLeft = '200px';

                // --- LOGIC SAMBUTAN ADMIN ---
                if (isAdmin && !sessionStorage.getItem('adminWelcome')) {
                    showCustomAlert("Haloo Admin! 👑", "Selamat datang kembali di Panel Utama! Ingat untuk selalu mengecek Status Pesanan ya! 🧑‍💻", false);
                    sessionStorage.setItem('adminWelcome', 'true');
                }
                
                // Update Coin
                document.getElementById("sjcoinAmount").textContent =
                  userData.sjcoin || 0;
                document.getElementById("sjcoinDisplay").style.display = "flex";

                // Setup event listener untuk tombol Inbox
                document
                  .getElementById("inboxButton")
                  .addEventListener("click", showNotificationPage);

                // Update badge notifikasi segera
                updateNotificationBadge();
              })
              .catch((error) => {
                console.error("Error getting user data:", error);
              });

          } else {
            // User is signed out
            toggleServiceCards(false); // Disable Cards
            
            // Tampilkan tombol Login/Signup di Header Atas
            userHeaderSlot.innerHTML = `
              <button class="auth-btn login-btn" id="loginBtn">Login</button>
              <button class="auth-btn signup-btn" id="signupBtn">Sign Up</button>
            `;
            
            document.querySelector('.promo-content-marquee').style.marginLeft = '0'; // Reset margin

            // Hide SJCoin display
            document.getElementById("sjcoinDisplay").style.display = "none";
            
            // Ulangi binding listener karena tombol dibuat ulang
            document
              .getElementById("loginBtn")
              .addEventListener("click", () => {
                loginModal.style.display = "block";
              });
            document
              .getElementById("signupBtn")
              .addEventListener("click", () => {
                signupModal.style.display = "block";
              });
          }
        };

        // Auth state observer
        auth.onAuthStateChanged(updateAuthUI);

        // Auth modals setup (Switch between modals)
        const switchToSignup = document.getElementById("switchToSignup");
        const switchToLogin = document.getElementById("switchToLogin");

        // Switch between modals
        switchToSignup.addEventListener("click", (e) => {
          e.preventDefault();
          loginModal.style.display = "none";
          signupModal.style.display = "block";
          goToStep(1); // Kembali ke step 1
        });

        switchToLogin.addEventListener("click", (e) => {
          e.preventDefault();
          signupModal.style.display = "none";
          loginModal.style.display = "block";
        });

        // Close modals
        document.querySelectorAll(".auth-modal .close-btn").forEach((btn) => {
          btn.addEventListener("click", () => {
            btn.closest(".auth-modal").style.display = "none";
          });
        });

        window.addEventListener("click", (e) => {
          if (e.target.classList.contains("auth-modal")) {
            e.target.style.display = "none";
          }
        });

        // Signup multi-step logic
        const steps = document.querySelectorAll(".step-indicator .step");
        const authSteps = document.querySelectorAll(".auth-step");

        function goToStep(stepNumber) {
          authSteps.forEach((s) => s.classList.remove("active"));
          document
            .querySelector(`#signupStep${stepNumber}`)
            .classList.add("active");

          steps.forEach((s) => {
            s.classList.remove("active", "completed");
            const sNum = parseInt(s.getAttribute("data-step"));
            if (sNum < stepNumber) {
              s.classList.add("completed");
            } else if (sNum === stepNumber) {
              s.classList.add("active");
            }
          });
        }

        document
          .getElementById("signupStep1Btn")
          .addEventListener("click", () => {
            if (!document.getElementById("signupName").value.trim()) {
              window.alert("Nama lengkap harus diisi.");
              return;
            }
            goToStep(2);
          });

        document
          .getElementById("signupBackBtn")
          .addEventListener("click", () => goToStep(1));
        document
          .getElementById("signupStep2Btn")
          .addEventListener("click", () => goToStep(3));
        document
          .getElementById("signupBackBtn2")
          .addEventListener("click", () => goToStep(2));

        // Handle Signup Submission
        document
          .getElementById("signupSubmitBtn")
          .addEventListener("click", () => {
            const name = document.getElementById("signupName").value;
            const address = document.getElementById("signupAddress").value;
            const phone = document.getElementById("signupPhone").value;
            const email = document.getElementById("signupEmail").value;
            const password = document.getElementById("signupPassword").value;
            const confirmPassword = document.getElementById(
              "signupConfirmPassword"
            ).value;

            if (!email || !name || !address || !phone) {
              window.alert("Semua data harus diisi sebelum mendaftar.");
              return;
            }
            if (password.length < 8) {
              window.alert("Kata sandi minimal 8 karakter.");
              return;
            }
            if (password !== confirmPassword) {
              window.alert("Konfirmasi kata sandi tidak cocok.");
              return;
            }

            const currentTime = new Date().getTime();
            if (currentTime - lastLoginTime < COOLDOWN_TIME) {
              window.alert("Tunggu beberapa saat sebelum mencoba lagi");
              return;
            }

            showLoadingScreen();

            auth
              .createUserWithEmailAndPassword(email, password)
              .then((userCredential) => {
                const user = userCredential.user;
                isFirstSignup = true;

                // Simpan data lengkap ke Firestore
                const userData = {
                  name: name,
                  address: address,
                  phone: phone,
                  email: email,
                  sjcoin: 0,
                  createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                };

                return db
                  .collection("users")
                  .doc(user.uid)
                  .set(userData)
                  .then(() => {
                    hideLoadingScreen();
                    signupModal.style.display = "none";
                    // Tampilkan Konfirmasi Akun (Langkah Baru)
                    showConfirmationModal(userData, isFirstSignup);
                    return user;
                  });
              })
              .catch((error) => {
                hideLoadingScreen();
                const { title, message } = mapErrorToInformal(error);
                showCustomAlert(title, message, true);
                console.error("Signup Error:", error);
              });
          });

        // Handle Login Submission
        document
          .getElementById("loginSubmitBtn")
          .addEventListener("click", () => {
            const email = document.getElementById("loginEmail").value;
            const password = document.getElementById("loginPassword").value;

            if (!email || !password) {
              window.alert("Email dan kata sandi harus diisi.");
              return;
            }

            const currentTime = new Date().getTime();
            if (currentTime - lastLoginTime < COOLDOWN_TIME) {
              window.alert("Tunggu beberapa saat sebelum login lagi");
              return;
            }

            showLoadingScreen();

            auth
              .signInWithEmailAndPassword(email, password)
              .then((userCredential) => {
                const user = userCredential.user;
                lastLoginTime = new Date().getTime();

                // Ambil data user dari Firestore untuk konfirmasi
                return db
                  .collection("users")
                  .doc(user.uid)
                  .get()
                  .then((doc) => {
                    hideLoadingScreen();
                    loginModal.style.display = "none";

                    const userData = doc.data() || {
                      name: user.displayName || user.email.split("@")[0],
                      email: user.email,
                      address: "Belum diisi",
                      phone: "Belum diisi",
                      sjcoin: 0,
                    };

                    // Tampilkan Konfirmasi Akun (Langkah Baru)
                    showConfirmationModal(userData, false);
                  });
              })
              .catch((error) => {
                hideLoadingScreen();
                const { title, message } = mapErrorToInformal(error);
                showCustomAlert(title, message, true);
                console.error("Login Error:", error);
              });
          });

        // --- GOOGLE AUTH ---
        const googleProvider = new firebase.auth.GoogleAuthProvider();

        function handleGoogleAuth(isSignupAttempt) {
          const currentTime = new Date().getTime();
          if (currentTime - lastLoginTime < COOLDOWN_TIME) {
            window.alert("Tunggu beberapa saat sebelum mencoba lagi");
            return;
          }
          showLoadingScreen();

          auth
            .signInWithPopup(googleProvider)
            .then((result) => {
              const user = result.user;
              lastLoginTime = new Date().getTime();

              const userRef = db.collection("users").doc(user.uid);
              return userRef.get().then((doc) => {
                const isNewUser = !doc.exists;

                let userData = {};
                if (isNewUser) {
                  userData = {
                    name: user.displayName,
                    email: user.email,
                    sjcoin: 0,
                    address: "Belum diisi",
                    phone: "Belum diisi",
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                  };

                  userRef.set(userData).then(() => {
                    db.collection("notifications").add({
                      userId: user.uid,
                      title: "Selamat Bergabung!",
                      content: "🥳hore! 50 SJcoin untuk kamu!",
                      timestamp:
                        firebase.firestore.FieldValue.serverTimestamp(),
                      read: false,
                      claimed: false,
                      coinReward: 50,
                    });
                  });
                } else {
                  userData = doc.data();
                }

                hideLoadingScreen();
                loginModal.style.display = "none";
                signupModal.style.display = "none";

                // Tampilkan Konfirmasi Akun (Langkah Baru)
                showConfirmationModal(userData, isNewUser);
              });
            })
            .catch((error) => {
              hideLoadingScreen();
              const { title, message } = mapErrorToInformal(error);
              showCustomAlert(title, message, true);
              console.error("Google Auth Error:", error);
            });
        }

        document
          .getElementById("googleLoginBtn")
          .addEventListener("click", () => handleGoogleAuth(false));
        document
          .getElementById("googleSignupBtn")
          .addEventListener("click", () => handleGoogleAuth(true));

        // --- Password Toggle ---
        function setupPasswordToggle(toggleId, inputId) {
          const toggle = document.getElementById(toggleId);
          const input = document.getElementById(inputId);
          toggle.addEventListener("click", function () {
            const type =
              input.getAttribute("type") === "password" ? "text" : "password";
            input.setAttribute("type", type);
            this.querySelector("i").classList.toggle("fa-eye");
            this.querySelector("i").classList.toggle("fa-eye-slash");
          });
        }
        setupPasswordToggle("toggleLoginPassword", "loginPassword");
        setupPasswordToggle("toggleSignupPassword", "signupPassword");
        setupPasswordToggle(
          "toggleSignupConfirmPassword",
          "signupConfirmPassword"
        );

        // Notification button (diganti menjadi Inbox)
        // Sudah diatur di updateAuthUI

        // Back button in notification page
        document.getElementById("backButton").addEventListener("click", () => {
          hideNotificationPage();
        });

        // Success button (Menggantikan alur notifikasi popup)
        document
          .getElementById("successButton")
          .addEventListener("click", handleSuccessAction);
      });
    </script>
  </body>
</html>
